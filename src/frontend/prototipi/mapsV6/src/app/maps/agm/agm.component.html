<div *ngIf="!map_loaded" class="mx-auto my-5">
    <img src="../../../assets/img/map_loading_resized.gif">
</div>
<agm-map [disableDefaultUI]="true"
         [zoomControl]="true"
         [zoomControlOptions]="zoomControlOptions"
         [fullscreenControl]="true"
         [fullscreenControlOptions]="fullscreenControlOptions"
         [streetViewControl]="false"
         [latitude]="centroMappa.coordinate.latitudine"
         [longitude]="centroMappa.coordinate.longitudine"
         [zoom]="centroMappa.zoom"
         (mapReady)="mappaCaricata($event)"
         (centerChange)="centroCambiato($event)"
         [usePanning]="true" (mapClick)="mappaCliccata()">
    <app-maps-filtro id="Settings"></app-maps-filtro>
    <agm-marker-cluster
            imagePath="https://raw.githubusercontent.com/googlemaps/v3-utility-library/master/markerclustererplus/images/m"
            [minimumClusterSize]="minMarkerCluster">
        <agm-marker *ngFor="let richiestaMarker of richiesteMarkers;"
                    [latitude]="richiestaMarker.getCoordinate().latitudine"
                    [longitude]="richiestaMarker.getCoordinate().longitudine"
                    (markerClick)="selezioneMarker(richiestaMarker)"
                    (mouseOver)="hoverMarker(richiestaMarker, 'in')"
                    (mouseOut)="hoverMarker(richiestaMarker, 'out')"
                    [iconUrl]="urlIcona(richiestaMarker)"
                    [visible]="isVisible(richiestaMarker)">
            <agm-info-window *ngIf="trueMarker(richiestaMarker)">
                <app-info-window [richiestaMarker]="richiestaMarker" [datiMeteo]="datiMeteo"></app-info-window>
            </agm-info-window>
        </agm-marker>
    </agm-marker-cluster>
    <agm-marker-cluster
            imagePath="https://raw.githubusercontent.com/googlemaps/v3-utility-library/master/markerclustererplus/images/m"
            [minimumClusterSize]="minMarkerCluster">
        <agm-marker *ngFor="let sedeMarker of sediMarkers;"
                    [latitude]="sedeMarker.getCoordinate().latitudine"
                    [longitude]="sedeMarker.getCoordinate().longitudine"
                    (markerClick)="selezioneMarker(sedeMarker)"
                    (mouseOver)="hoverMarker(sedeMarker, 'in')"
                    (mouseOut)="hoverMarker(sedeMarker, 'out')"
                    [iconUrl]="urlIcona(sedeMarker)"
                    [visible]="isVisible(sedeMarker)">
            <agm-info-window *ngIf="trueMarker(sedeMarker)">
                <app-info-window [sedeMarker]="sedeMarker" [datiMeteo]="datiMeteo"></app-info-window>
            </agm-info-window>
        </agm-marker>
    </agm-marker-cluster>
    <agm-marker-cluster
            imagePath="https://raw.githubusercontent.com/googlemaps/v3-utility-library/master/markerclustererplus/images/m"
            [minimumClusterSize]="minMarkerCluster">
        <agm-marker *ngFor="let mezzoMarker of mezziMarkers;"
                    [latitude]="mezzoMarker.getCoordinate().latitudine"
                    [longitude]="mezzoMarker.getCoordinate().longitudine"
                    (markerClick)="selezioneMarker(mezzoMarker)"
                    (mouseOver)="hoverMarker(mezzoMarker, 'in')"
                    (mouseOut)="hoverMarker(mezzoMarker, 'out')"
                    [iconUrl]="urlIcona(mezzoMarker)"
                    [visible]="isVisible(mezzoMarker)">
            <agm-info-window *ngIf="trueMarker(mezzoMarker)">
                <app-info-window [mezzoMarker]="mezzoMarker" [datiMeteo]="datiMeteo"></app-info-window>
            </agm-info-window>
        </agm-marker>
    </agm-marker-cluster>
    <app-agm-content (mapLoad)='loadAPIWrapper($event)'></app-agm-content>
</agm-map>